/// uDevTools.js
!async function() {
    try {
        let isVisible = false; 
        let t = {
            url_is_chii: function(t) {
                let e = new URL(t);
                return "chii.liriliri.io" === e.host && "/front_end/chii_app.html" === e.pathname;
            },
            get_chii_frame: function() {
                return [...document.querySelectorAll("iframe[src]")].find(function(t) {
                    return t.getAttribute("src");
                });
            },
            toggle_chii: function() {
                let frame = this.get_chii_frame();
                if (frame) {
                    isVisible = !isVisible; 
                    frame.parentNode.style.display = isVisible ? '' : 'none';
                    document.body.style.height = isVisible ? 
                        (document.documentElement.clientHeight - Math.floor(Number(localStorage["chii-embedded-height"] || document.documentElement.clientHeight / 2) || 100)) + "px" : 
                        "none";
                }
            }
        };

        if (!t.url_is_chii(window.location)) {
            let e = document.createElement("script");
            e.setAttribute("embedded", "true");
            e.setAttribute("src", "https://chii.liriliri.io/target.js");
            e.addEventListener("load", t.toggle_chii);
            (document.readyState === "loading" ? document.addEventListener("DOMContentLoaded", function() {
                document.head.appendChild(this);
            }.bind(e) ) : document.body.appendChild(e));

            document.addEventListener("keydown", function(event) {
                if (event.ctrlKey && event.altKey && event.key === "i") {
                    t.toggle_chii();
                }
            });
        }
    } catch (error) {
        console.error("Error in uDevTools.js:", error);
    }
}();
